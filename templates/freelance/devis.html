<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Devis n°{{devis_number}}</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      font-size: 14px;
      color: #111827;
      margin: 40px;
    }
    h1, h2, h3 {
      margin: 0;
      padding: 0;
    }
    .header, .footer {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 24px;
    }
    .section {
      margin-bottom: 24px;
    }
    .muted {
      color: #6B7280;
      font-size: 12px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }
    th, td {
      border: 1px solid #E5E7EB;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #F9FAFB;
    }
    .text-right {
      text-align: right;
    }
    .total-row {
      font-weight: 600;
      background-color: #F3F4F6;
    }
  </style>
</head>
<body>
  <!-- En-tête -->
  <div class="header">
    <div>
      <h1>Devis</h1>
      <p class="muted">
        Devis n° {{devis_number}}<br />
        Date : {{devis_date}}<br />
        Valable jusqu'au : {{valid_until}}
      </p>
    </div>
    <div>
      <strong>{{freelance_name}}</strong><br />
      {{freelance_activity}}<br />
      {{freelance_address}}<br />
      {{freelance_zip}} {{freelance_city}}<br />
      SIRET : {{freelance_siret}}<br />
      Email : {{freelance_email}}<br />
      Téléphone : {{freelance_phone}}
    </div>
  </div>

  <!-- Client -->
  <div class="section">
    <h2>Client</h2>
    <p>
      <strong>{{client_name}}</strong><br />
      {{client_company}}<br />
      {{client_address}}<br />
      {{client_zip}} {{client_city}}<br />
      {{client_email}}
    </p>
  </div>

  <!-- Détails de la prestation -->
  <div class="section">
    <h2>Détails de la prestation</h2>
    <p>{{project_title}}</p>
    <p class="muted">{{project_description}}</p>

    <table>
      <thead>
        <tr>
          <th>Prestation</th>
          <th>Quantité</th>
          <th>Prix unitaire HT</th>
          <th>Total HT</th>
        </tr>
      </thead>
      <tbody>
        {{#each items}}
        <tr>
          <td>{{this.label}}</td>
          <td>{{this.quantity}}</td>
          <td>{{this.unit_price}} €</td>
          <td>{{this.total}} €</td>
        </tr>
        {{/each}}
      </tbody>
      <tfoot>
        <tr>
          <td colspan="3" class="text-right">Sous-total HT</td>
          <td>{{subtotal_ht}} €</td>
        </tr>
        <tr>
          <td colspan="3" class="text-right">TVA ({{tva_rate}} %)</td>
          <td>{{tva_amount}} €</td>
        </tr>
        <tr class="total-row">
          <td colspan="3" class="text-right">Total TTC</td>
          <td>{{total_ttc}} €</td>
        </tr>
      </tfoot>
    </table>
  </div>

  <!-- Conditions -->
  <div class="section">
    <h2>Conditions</h2>
    <p>
      Délais de réalisation : {{delivery_delay}}<br />
      Modalités de paiement : {{payment_terms}}<br />
      Acompte : {{deposit_percent}} % soit {{deposit_amount}} €
    </p>
    <p class="muted">
      Le présent devis est valable jusqu'au {{valid_until}}. <br />
      Toute acceptation vaut accord sur les conditions générales de vente.
    </p>
  </div>

  <!-- Signature -->
  <div class="section">
    <h2>Acceptation du devis</h2>
    <p>
      Fait à {{freelance_city}}, le {{signature_date}}<br /><br />
      Signature précédée de la mention « Bon pour accord » :
    </p>
    <p>__________________________________________</p>
  </div>

  <!-- Footer -->
  <div class="footer">
    <p class="muted">
      {{freelance_name}} — {{freelance_activity}}<br />
      {{freelance_legal_notice}}
    </p>
    <p class="muted">
      DocPilot — Génération automatique de documents pour freelances
    </p>
  </div>
</body>
</html>
